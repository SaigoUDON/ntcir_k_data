赤 の ライン が え 拡張 前 の え 厳密 アルゴリズム 